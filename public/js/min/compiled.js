!function e(t,n,r){function a(o,s){if(!n[o]){if(!t[o]){var l="function"==typeof require&&require;if(!s&&l)return l(o,!0);if(i)return i(o,!0);var c=new Error("Cannot find module '"+o+"'");throw c.code="MODULE_NOT_FOUND",c}var u=n[o]={exports:{}};t[o][0].call(u.exports,function(e){var n=t[o][1][e];return a(n?n:e)},u,u.exports,e,t,n,r)}return n[o].exports}for(var i="function"==typeof require&&require,o=0;o<r.length;o++)a(r[o]);return a}({1:[function(e,t,n){var r=(e("../lib/services.js"),e("../lib/geo_lit.js")),a=e("../lib/user/lib/modal.jsx"),i=e("../lib/user/lib/alert.jsx"),o="Place title is not long enough.",s={position:"absolute",top:"5px",left:"5px"};t.exports=React.createClass({displayName:"exports",validation:{minPlaceLength:4},addPlace:function(e){var t=this;e.preventDefault();var n=this.state.placeValue,a=this.validatePlace(n);return a!==!0?void t.setState({errorMessage:a}):void r.addPlace(this.state.placeValue,function(e,n){e?t.setState({errorMessage:e}):t.props.addPlaceCallback&&t.setState({errorMessage:"",placeValue:"",modalVisible:!1},function(){t.props.addPlaceCallback&&t.props.addPlaceCallback(n)})})},getInitialState:function(){return{placeValue:"",errorMessage:"",modalVisible:!1}},handleModalClose:function(){this.setState({modalVisible:!1})},handleShowFormClick:function(e){this.setState({modalVisible:!0})},validatePlace:function(e){return e.trim().length<this.validation.minPlaceLength?o:!0},render:function(){var e=this,t="js-add-place button expand";return""!==e.props.activeComponent?React.createElement("div",null,React.createElement("button",{className:"sql-login-button button tiny",style:s,onClick:this.handleShowFormClick},"Add Place"),React.createElement(a,{visible:this.state.modalVisible,handleClose:this.handleModalClose},React.createElement(i,{message:this.state.errorMessage}),React.createElement("form",null,React.createElement("div",{className:"row"},React.createElement("div",{className:"small-12 columns"},React.createElement("input",{type:"text",name:"title",placeholder:"Title",value:this.state.placeValue,onChange:this.updatePlaceValue}),React.createElement("a",{href:"javascript:void(0)",onClick:this.addPlace,className:t},"Add Place")))))):void 0},updatePlaceValue:function(e){this.setState({placeValue:e.target.value})}})},{"../lib/geo_lit.js":3,"../lib/services.js":5,"../lib/user/lib/alert.jsx":7,"../lib/user/lib/modal.jsx":10}],2:[function(e,t,n){var r=e("underscore"),a="A server error occurred.";t.exports=React.createClass({displayName:"exports",addComment:function(e,t){var n=this,r=n.props.endpoint+"/comment/"+n.props.placeId+"/"+e;$.ajax({type:"POST",url:r,data:{comment:t},success:function(e){"success"!==e.status?n.triggerNotice(e.errorMessage):(n.setState({hasLoaded:!1}),n.loadComments(n.props.placeId))},error:function(e){console.log(e),n.triggerNotice(a)},dataType:"JSON"})},handleFlag:function(e){var t=this,n=t.props.endpoint+"/flag/"+e;$.ajax({type:"POST",url:n,success:function(e){"success"!==e.status?t.triggerNotice(e.errorMessage):t.triggerNotice("Comment Flagged")},error:function(e){t.triggerNotice(a)},dataType:"JSON"})},handleVote:function(e,t){var n=this,r=n.props.endpoint+"/comment/vote/"+e+"/"+t;$.ajax({type:"POST",url:r,success:function(e){"success"!==e.status?n.triggerNotice(e.errorMessage):n.triggerNotice("Vote Added")},error:function(e){n.triggerNotice(a)},dataType:"JSON"})},cleanComments:function(e){var t=this;r.each(e,function(e){e.addComment=t.addComment,e.handleVote=t.handleVote,e.handleFlag=t.handleFlag,0!==e.children.length&&t.cleanComments(e.children)})},componentDidMount:function(){this.loadComments(this.props.placeId)},componentWillReceiveProps:function(e){e.placeId!==this.props.placeId&&(this.loadComments(e.placeId),this.setState({hasLoaded:!1}))},getInitialState:function(){return{hasLoaded:!1,comments:[],notice:null}},triggerNotice:function(e){var t=this,n=React.createElement("div",{style:{position:"fixed",top:"10px",right:"10px"},className:"alert-box alert"},e);t.setState({notice:n},function(){setTimeout(function(){t.setState({notice:null})},2e3)})},loadComments:function(e){var t=this;$.ajax({type:"GET",url:t.props.endpoint+"/comments-formatted/"+e,success:function(e){"success"!==e.status?(console.log(e),t.triggerNotice(e.errorMessage)):(t.cleanComments(e.data),t.setState({comments:e.data,hasLoaded:!0}))},error:function(e){console.log(e),t.triggerNotice(a)},dataType:"JSON"})},render:function(){var e=this;return this.state.hasLoaded?React.createElement("div",null,e.state.notice,React.createElement(o,{children:[],isTopLevel:!0,addComment:this.addComment}),React.createElement(i,{comments:this.state.comments})):null},updatePlaceValue:function(e){this.setState({placeValue:e.target.value})}});var i=React.createClass({displayName:"Comments",render:function(){var e=this.props.comments.map(function(e,t){var n=!1;null===e.comment&&(n=!0);var r="";return 0!==e.children.length&&(r=React.createElement(i,{comments:e.children})),React.createElement(o,{addComment:e.addComment,children:e.children,childrenElement:r,parent:e.id,comment:e.comment,created:e.created,handleVote:e.handleVote,handleFlag:e.handleFlag,id:e.id,isTopLevel:!1,key:t,rank:e.rank})});return React.createElement("div",null,e)},updateComment:function(e){this.setState({comment:e.target.value})}}),o=React.createClass({displayName:"Comment",getInitialState:function(){return{comment:"",showCommentForm:!1,showControls:!1,showChildren:!0}},handleCancel:function(){this.setState({showCommentForm:!1})},handleSubmit:function(e){e.preventDefault(),e.stopPropagation(),this.props.addComment(this.props.parent,this.state.comment)},handleShowControl:function(){this.setState({showControls:!this.state.showControls})},handleToggleChilren:function(){var e=!this.state.showChildren;this.setState({showChildren:e,showControls:!1})},handleToggleCommentForm:function(){var e=!this.state.showCommentForm;this.setState({showCommentForm:e})},handleUpvote:function(){this.props.handleVote("up",this.props.id)},handleFlag:function(){this.props.handleFlag(this.props.id)},handleDownvote:function(){this.props.handleVote("down",this.props.id)},render:function(){var e=this,t=this.state.showCommentForm&&this.state.showControls?{display:"block",marginTop:"10px"}:{display:"none"};e.props.isTopLevel&&(t={display:"block",marginTop:"10px"});var n=(e.state.showChildren?"-":"+",e.state.showChildren?{display:"block"}:{display:"none"}),r=(0===e.props.children.length?{display:"none"}:{display:"block"},e.props.rank?e.props.rank:0),a=new Date(1e3*e.props.created).toString(),i=this.props.children.length>0;return React.createElement("div",{className:"sql-comment-container",style:{marginTop:"10px"}},React.createElement("div",{className:"sql-comment-comment-meta",style:e.props.isTopLevel?{display:"none"}:{marginTop:"10px"}},React.createElement("span",{className:"sql-comment-username"},"danpaul")," -",React.createElement("span",{className:"sql-comment-date"}," ",a)," -",React.createElement("span",{style:{marginLeft:"3px",position:"relative",top:"1px"}},r)),React.createElement("div",{style:{cursor:"pointer"},onClick:e.handleShowControl},this.props.comment),React.createElement("div",{style:this.state.showControls?{display:"block"}:{display:"none"}}),React.createElement("div",{style:this.state.showControls?{display:"block"}:{display:"none"}},React.createElement("a",{onClick:this.handleUpvote},React.createElement("i",{className:"fi-arrow-up"})),"  ",React.createElement("a",{onClick:this.handleDownvote},React.createElement("i",{className:"fi-arrow-down"})),"  ",React.createElement("a",{onClick:this.handleFlag},React.createElement("i",{className:"fi-flag"})),"  ",React.createElement("a",{onClick:this.handleToggleCommentForm},React.createElement("i",{className:"fi-comment"})),React.createElement("span",{style:i?{display:"inline"}:{display:"none"}},"  ",React.createElement("a",{onClick:this.handleToggleChilren},this.state.showChildren?React.createElement("i",{className:"fi-arrows-compress"}):React.createElement("i",{className:"fi-arrows-expand"})))),React.createElement("div",{style:t},React.createElement("textarea",{placeholder:"Add Comment",onChange:e.updateComment,value:e.state.comment}),React.createElement("button",{href:"javascript:null;",className:"button small",onClick:e.handleSubmit},"Submit"),React.createElement("button",{href:"javascript:null;",className:"button small inverted left-padded",onClick:e.handleCancel},"Cancel")),React.createElement("div",{style:n},this.props.childrenElement))},updateComment:function(e){this.setState({comment:e.target.value})}})},{underscore:15}],3:[function(e,t,n){function r(e,t,n){this.marker_=e,this.handCursorURL_=e.handCursorURL,this.labelDiv_=document.createElement("div"),this.labelDiv_.style.cssText="position: absolute; overflow: hidden;",this.eventDiv_=document.createElement("div"),this.eventDiv_.style.cssText=this.labelDiv_.style.cssText,this.eventDiv_.setAttribute("onselectstart","return false;"),this.eventDiv_.setAttribute("ondragstart","return false;"),this.crossDiv_=r.getSharedCross(t)}function a(e){e=e||{},e.labelContent=e.labelContent||"",e.labelAnchor=e.labelAnchor||new google.maps.Point(0,0),e.labelClass=e.labelClass||"markerLabels",e.labelStyle=e.labelStyle||{},e.labelInBackground=e.labelInBackground||!1,"undefined"==typeof e.labelVisible&&(e.labelVisible=!0),"undefined"==typeof e.raiseOnDrag&&(e.raiseOnDrag=!0),"undefined"==typeof e.clickable&&(e.clickable=!0),"undefined"==typeof e.draggable&&(e.draggable=!1),"undefined"==typeof e.optimized&&(e.optimized=!1),e.crossImage=e.crossImage||"http"+("https:"===document.location.protocol?"s":"")+"://maps.gstatic.com/intl/en_us/mapfiles/drag_cross_67_16.png",e.handCursor=e.handCursor||"http"+("https:"===document.location.protocol?"s":"")+"://maps.gstatic.com/intl/en_us/mapfiles/closedhand_8_8.cur",e.optimized=!1,this.label=new r(this,e.crossImage,e.handCursor),google.maps.Marker.apply(this,arguments)}var i=e("./map_styles"),o=(e("../../config"),{}),s=e("underscore"),l=e("./services"),c=6,u=.5,p=5,d=!1,m=.1;o.map=null,o.currentLatitude=null,o.currentLongitude=null,o.mapFollow=!0,o.intervalId=null,o.intervalTime=5e3,o.mapId=null,o.placeMarkers={},o.userMarker=null,o.zoomLevel=12,o.user=null,o.createMap=function(){var e={zoom:o.zoomLevel,center:new google.maps.LatLng(o.currentLatitude,o.currentLongitude)};o.map=new google.maps.Map(document.getElementById(o.mapId),e),o.map.set("styles",i)},o.getPosition=function(e){navigator.geolocation.getCurrentPosition(function(t){e(null,{latitude:t.coords.latitude,longitude:t.coords.longitude})},e)},o.init=function(e,t){o.mapId=e,google.maps.event.addDomListener(window,"load",function(){o.updatePosition(function(e){e?t(e):(o.createMap(),o.updateUserMarker(),o.intervalId=window.setInterval(o.intervalCallback,o.intervalTime),t())})})},o.updatePosition=function(e){navigator.geolocation.getCurrentPosition(function(t){o.currentLatitude=t.coords.latitude,o.currentLongitude=t.coords.longitude,e()},e)},o.addPlacesToMap=function(e){s.each(e,function(e){var t={path:google.maps.SymbolPath.CIRCLE,fillColor:"#A22C29",strokeColor:"#902923",fillOpacity:u,scale:c},n=new google.maps.LatLng(e.location[1],e.location[0]);o.placeMarkers[e._id]=new google.maps.Marker({icon:t,position:n,map:o.map,title:e.title,geoLit:{_id:e._id,title:e.title}}),google.maps.event.addListener(o.placeMarkers[e._id],"click",function(){$(document).trigger("geo-lit-place-click",[this.geoLit])})})},o.updatePlaces=function(e){l.findNear({latitude:o.currentLatitude,longitude:o.currentLongitude,range:p},function(e,t){var n=s.filter(t,function(e){return"undefined"==typeof o.placeMarkers[e._id]});o.addPlacesToMap(n)})},o.updateUserMarker=function(){var e=new google.maps.LatLng(o.currentLatitude,o.currentLongitude);null===o.userMarker?o.userMarker=new a({position:o.map.getCenter(),icon:{path:google.maps.SymbolPath.CIRCLE,scale:0},map:o.map,labelAnchor:new google.maps.Point(10,10),labelClass:"user-marker"}):o.userMarker.setPosition(e),o.mapFollow&&o.recenterMap()},o.recenterMap=function(){var e=new google.maps.LatLng(o.currentLatitude,o.currentLongitude);o.map.panTo(e)},o.intervalCallback=function(){var e=!0;o.updatePosition(function(t){return d&&(o.currentLatitude+=Math.random()*m,o.currentLongitude+=Math.random()*m),t?void console.log(t):(o.updateUserMarker(),void(e&&o.updatePlaces(function(e){e&&console.log(e)})))})},o.addPlace=function(e,t){return o.user?void o.getPosition(function(n,r){if(n)return void t("Unable to find location.");var a={};a.location=[r.longitude,r.latitude],a.title=e,a.user=o.user.id,l.add(a,function(e,n){e?t(e):t(null,n)})}):void t("User must be logged in to add place.")},o.setUser=function(e){o.user=e},t.exports=o,r.prototype=new google.maps.OverlayView,r.getSharedCross=function(e){var t;return"undefined"==typeof r.getSharedCross.crossDiv&&(t=document.createElement("img"),t.style.cssText="position: absolute; z-index: 1000002; display: none;",t.style.marginLeft="-8px",t.style.marginTop="-9px",t.src=e,r.getSharedCross.crossDiv=t),r.getSharedCross.crossDiv},r.prototype.onAdd=function(){var e,t,n,a,i,o,s,l=this,c=!1,u=!1,p=20,d="url("+this.handCursorURL_+")",m=function(e){e.preventDefault&&e.preventDefault(),e.cancelBubble=!0,e.stopPropagation&&e.stopPropagation()},f=function(){l.marker_.setAnimation(null)};this.getPanes().overlayImage.appendChild(this.labelDiv_),this.getPanes().overlayMouseTarget.appendChild(this.eventDiv_),"undefined"==typeof r.getSharedCross.processed&&(this.getPanes().overlayImage.appendChild(this.crossDiv_),r.getSharedCross.processed=!0),this.listeners_=[google.maps.event.addDomListener(this.eventDiv_,"mouseover",function(e){(l.marker_.getDraggable()||l.marker_.getClickable())&&(this.style.cursor="pointer",google.maps.event.trigger(l.marker_,"mouseover",e))}),google.maps.event.addDomListener(this.eventDiv_,"mouseout",function(e){!l.marker_.getDraggable()&&!l.marker_.getClickable()||u||(this.style.cursor=l.marker_.getCursor(),google.maps.event.trigger(l.marker_,"mouseout",e))}),google.maps.event.addDomListener(this.eventDiv_,"mousedown",function(e){u=!1,l.marker_.getDraggable()&&(c=!0,this.style.cursor=d),(l.marker_.getDraggable()||l.marker_.getClickable())&&(google.maps.event.trigger(l.marker_,"mousedown",e),m(e))}),google.maps.event.addDomListener(document,"mouseup",function(t){var n;if(c&&(c=!1,l.eventDiv_.style.cursor="pointer",google.maps.event.trigger(l.marker_,"mouseup",t)),u){if(i){n=l.getProjection().fromLatLngToDivPixel(l.marker_.getPosition()),n.y+=p,l.marker_.setPosition(l.getProjection().fromDivPixelToLatLng(n));try{l.marker_.setAnimation(google.maps.Animation.BOUNCE),setTimeout(f,1406)}catch(r){}}l.crossDiv_.style.display="none",l.marker_.setZIndex(e),a=!0,u=!1,t.latLng=l.marker_.getPosition(),google.maps.event.trigger(l.marker_,"dragend",t)}}),google.maps.event.addListener(l.marker_.getMap(),"mousemove",function(r){var a;c&&(u?(r.latLng=new google.maps.LatLng(r.latLng.lat()-t,r.latLng.lng()-n),a=l.getProjection().fromLatLngToDivPixel(r.latLng),i&&(l.crossDiv_.style.left=a.x+"px",l.crossDiv_.style.top=a.y+"px",l.crossDiv_.style.display="",a.y-=p),l.marker_.setPosition(l.getProjection().fromDivPixelToLatLng(a)),i&&(l.eventDiv_.style.top=a.y+p+"px"),google.maps.event.trigger(l.marker_,"drag",r)):(t=r.latLng.lat()-l.marker_.getPosition().lat(),n=r.latLng.lng()-l.marker_.getPosition().lng(),e=l.marker_.getZIndex(),o=l.marker_.getPosition(),s=l.marker_.getMap().getCenter(),i=l.marker_.get("raiseOnDrag"),u=!0,l.marker_.setZIndex(1e6),r.latLng=l.marker_.getPosition(),google.maps.event.trigger(l.marker_,"dragstart",r)))}),google.maps.event.addDomListener(document,"keydown",function(e){u&&27===e.keyCode&&(i=!1,l.marker_.setPosition(o),l.marker_.getMap().setCenter(s),google.maps.event.trigger(document,"mouseup",e))}),google.maps.event.addDomListener(this.eventDiv_,"click",function(e){(l.marker_.getDraggable()||l.marker_.getClickable())&&(a?a=!1:(google.maps.event.trigger(l.marker_,"click",e),m(e)))}),google.maps.event.addDomListener(this.eventDiv_,"dblclick",function(e){(l.marker_.getDraggable()||l.marker_.getClickable())&&(google.maps.event.trigger(l.marker_,"dblclick",e),m(e))}),google.maps.event.addListener(this.marker_,"dragstart",function(e){u||(i=this.get("raiseOnDrag"))}),google.maps.event.addListener(this.marker_,"drag",function(e){u||i&&(l.setPosition(p),l.labelDiv_.style.zIndex=1e6+(this.get("labelInBackground")?-1:1))}),google.maps.event.addListener(this.marker_,"dragend",function(e){u||i&&l.setPosition(0)}),google.maps.event.addListener(this.marker_,"position_changed",function(){l.setPosition()}),google.maps.event.addListener(this.marker_,"zindex_changed",function(){l.setZIndex()}),google.maps.event.addListener(this.marker_,"visible_changed",function(){l.setVisible()}),google.maps.event.addListener(this.marker_,"labelvisible_changed",function(){l.setVisible()}),google.maps.event.addListener(this.marker_,"title_changed",function(){l.setTitle()}),google.maps.event.addListener(this.marker_,"labelcontent_changed",function(){l.setContent()}),google.maps.event.addListener(this.marker_,"labelanchor_changed",function(){l.setAnchor()}),google.maps.event.addListener(this.marker_,"labelclass_changed",function(){l.setStyles()}),google.maps.event.addListener(this.marker_,"labelstyle_changed",function(){l.setStyles()})]},r.prototype.onRemove=function(){var e;for(this.labelDiv_.parentNode.removeChild(this.labelDiv_),this.eventDiv_.parentNode.removeChild(this.eventDiv_),e=0;e<this.listeners_.length;e++)google.maps.event.removeListener(this.listeners_[e])},r.prototype.draw=function(){this.setContent(),this.setTitle(),this.setStyles()},r.prototype.setContent=function(){var e=this.marker_.get("labelContent");"undefined"==typeof e.nodeType?(this.labelDiv_.innerHTML=e,this.eventDiv_.innerHTML=this.labelDiv_.innerHTML):(this.labelDiv_.innerHTML="",this.labelDiv_.appendChild(e),e=e.cloneNode(!0),this.eventDiv_.appendChild(e))},r.prototype.setTitle=function(){this.eventDiv_.title=this.marker_.getTitle()||""},r.prototype.setStyles=function(){var e,t;this.labelDiv_.className=this.marker_.get("labelClass"),this.eventDiv_.className=this.labelDiv_.className,this.labelDiv_.style.cssText="",this.eventDiv_.style.cssText="",t=this.marker_.get("labelStyle");for(e in t)t.hasOwnProperty(e)&&(this.labelDiv_.style[e]=t[e],this.eventDiv_.style[e]=t[e]);this.setMandatoryStyles()},r.prototype.setMandatoryStyles=function(){this.labelDiv_.style.position="absolute",this.labelDiv_.style.overflow="hidden","undefined"!=typeof this.labelDiv_.style.opacity&&""!==this.labelDiv_.style.opacity&&(this.labelDiv_.style.filter="alpha(opacity="+100*this.labelDiv_.style.opacity+")"),this.eventDiv_.style.position=this.labelDiv_.style.position,this.eventDiv_.style.overflow=this.labelDiv_.style.overflow,this.eventDiv_.style.opacity=.01,this.eventDiv_.style.filter="alpha(opacity=1)",this.setAnchor(),this.setPosition(),this.setVisible()},r.prototype.setAnchor=function(){var e=this.marker_.get("labelAnchor");this.labelDiv_.style.marginLeft=-e.x+"px",this.labelDiv_.style.marginTop=-e.y+"px",this.eventDiv_.style.marginLeft=-e.x+"px",this.eventDiv_.style.marginTop=-e.y+"px"},r.prototype.setPosition=function(e){var t=this.getProjection().fromLatLngToDivPixel(this.marker_.getPosition());"undefined"==typeof e&&(e=0),this.labelDiv_.style.left=Math.round(t.x)+"px",this.labelDiv_.style.top=Math.round(t.y-e)+"px",this.eventDiv_.style.left=this.labelDiv_.style.left,this.eventDiv_.style.top=this.labelDiv_.style.top,this.setZIndex()},r.prototype.setZIndex=function(){var e=this.marker_.get("labelInBackground")?-1:1;"undefined"==typeof this.marker_.getZIndex()?(this.labelDiv_.style.zIndex=parseInt(this.labelDiv_.style.top,10)+e,this.eventDiv_.style.zIndex=this.labelDiv_.style.zIndex):(this.labelDiv_.style.zIndex=this.marker_.getZIndex()+e,this.eventDiv_.style.zIndex=this.labelDiv_.style.zIndex)},r.prototype.setVisible=function(){this.marker_.get("labelVisible")?this.labelDiv_.style.display=this.marker_.getVisible()?"block":"none":this.labelDiv_.style.display="none",this.eventDiv_.style.display=this.labelDiv_.style.display},a.prototype=new google.maps.Marker,a.prototype.setMap=function(e){google.maps.Marker.prototype.setMap.apply(this,arguments),this.label.setMap(e)}},{"../../config":14,"./map_styles":4,"./services":5,underscore:15}],4:[function(e,t,n){t.exports=[{featureType:"administrative",elementType:"labels.text.fill",stylers:[{color:"#444444"}]},{featureType:"landscape",elementType:"all",stylers:[{color:"#f2f2f2"}]},{featureType:"landscape.natural",elementType:"all",stylers:[{visibility:"on"}]},{featureType:"landscape.natural",elementType:"geometry",stylers:[{visibility:"on"}]},{featureType:"landscape.natural.landcover",elementType:"geometry.fill",stylers:[{visibility:"on"}]},{featureType:"poi",elementType:"all",stylers:[{visibility:"off"}]},{featureType:"poi",elementType:"labels.text",stylers:[{color:"#101010"}]},{featureType:"poi.attraction",elementType:"labels",stylers:[{visibility:"on"},{hue:"#ff0000"}]},{featureType:"poi.attraction",elementType:"labels.text.fill",stylers:[{visibility:"off"}]},{featureType:"poi.attraction",elementType:"labels.text.stroke",stylers:[{visibility:"on"}]},{featureType:"poi.business",elementType:"geometry.fill",stylers:[{visibility:"on"}]},{featureType:"poi.business",elementType:"labels",stylers:[{visibility:"on"}]},{featureType:"poi.business",elementType:"labels.text.fill",stylers:[{visibility:"off"}]},{featureType:"poi.business",elementType:"labels.text.stroke",stylers:[{color:"#656565"}]},{featureType:"poi.park",elementType:"geometry",stylers:[{visibility:"off"}]},{featureType:"poi.place_of_worship",elementType:"geometry.fill",stylers:[{visibility:"off"}]},{featureType:"poi.place_of_worship",elementType:"labels",stylers:[{visibility:"on"}]},{featureType:"poi.place_of_worship",elementType:"labels.text.fill",stylers:[{visibility:"off"}]},{featureType:"poi.school",elementType:"geometry.fill",stylers:[{color:"#ff0000"},{visibility:"off"}]},{featureType:"poi.school",elementType:"labels.text",stylers:[{visibility:"on"}]},{featureType:"poi.school",elementType:"labels.text.fill",stylers:[{visibility:"off"},{color:"#ff0000"}]},{featureType:"poi.school",elementType:"labels.text.stroke",stylers:[{visibility:"on"},{color:"#363636"}]},{featureType:"poi.school",elementType:"labels.icon",stylers:[{visibility:"on"},{hue:"#ff0000"}]},{featureType:"road",elementType:"all",stylers:[{saturation:-100},{lightness:45}]},{featureType:"road.highway",elementType:"all",stylers:[{visibility:"simplified"}]},{featureType:"road.highway",elementType:"geometry.fill",stylers:[{visibility:"on"},{color:"#ababab"}]},{featureType:"road.highway",elementType:"geometry.stroke",stylers:[{visibility:"off"}]},{featureType:"road.highway",elementType:"labels.text.fill",stylers:[{visibility:"on"},{color:"#3f3f3f"}]},{featureType:"road.arterial",elementType:"labels.icon",stylers:[{visibility:"off"}]},{featureType:"road.local",elementType:"geometry",stylers:[{visibility:"off"},{color:"#646464"}]},{featureType:"road.local",elementType:"geometry.fill",stylers:[{visibility:"off"}]},{featureType:"road.local",elementType:"geometry.stroke",stylers:[{visibility:"on"},{weight:"0.76"},{color:"#ffffff"}]},{featureType:"road.local",elementType:"labels.text",stylers:[{color:"#ff0000"}]},{featureType:"road.local",elementType:"labels.text.fill",stylers:[{color:"#9a9a9a"}]},{featureType:"road.local",elementType:"labels.text.stroke",stylers:[{visibility:"off"}]},{featureType:"transit",elementType:"all",stylers:[{visibility:"off"}]},{featureType:"transit.station",elementType:"all",stylers:[{visibility:"on"}]},{featureType:"water",elementType:"all",stylers:[{color:"#ffffff"},{visibility:"on"}]}]},{}],5:[function(e,t,n){var r={},a=e("../../config.js"),i="A server error occurred.";r.add=function(e,t){$.ajax({type:"POST",url:a.geoLitEndpoint+"/position",data:e,success:function(e){"success"===e.status?t(null,e.data):t(data.errorMessage)},error:function(e){console.log(e),t(i)},dataType:"JSON"})},r.findNear=function(e,t){$.ajax({type:"GET",url:a.geoLitEndpoint+"/positions-near",data:e,success:function(e){"success"!==e.status?t(e.errorMessage):t(null,e.data)},error:function(e){console.log(e),t(i)},dataType:"JSON"})},t.exports=r},{"../../config.js":14}],6:[function(e,t,n){var r=(e("./lib/input.jsx"),e("./lib/login_form.jsx")),a=e("./lib/register_form.jsx"),i=e("./lib/modal.jsx"),o=e("./lib/services_handler.js"),s={position:"absolute",top:"5px",right:"5px"};t.exports=React.createClass({displayName:"exports",getInitialState:function(){return this.loadUser(),{activeForm:"login",isLoggedIn:!1,user:null,userFormIsVisible:!1,hasLoaded:!1}},handleClose:function(e){this.setState({userFormIsVisible:!1})},handleMenuClickLogin:function(e){this.setState({activeForm:"login"})},handleMenuClickRegister:function(e){this.setState({activeForm:"register"})},handleLoginButtonClick:function(e){var t=this;return t.state.isLoggedIn?void o.logout(t.props.endpoint,function(e){return e?void alert(e):void t.setState({isLoggedIn:!1},function(){t.props.logoutCallback&&t.props.logoutCallback()})}):void t.setState({userFormIsVisible:!0})},loadUser:function(){var e=this;o.getUser(e.props.endpoint,function(t,n){return!t&&n&&n.id?void e.setState({isLoggedIn:!0,user:n,hasLoaded:!0},function(){e.props.loginCallback&&e.props.loginCallback(n)}):(console.log(t),void e.setState({hasLoaded:!0}))})},loginCallback:function(e){var t=this;t.setState({isLoggedIn:!0,user:e,userFormIsVisible:!1},function(){t.props.loginCallback&&t.props.loginCallback(e)})},render:function(){var e=this;if(!e.state.hasLoaded)return null;var t={},n=["login","register"];return n.forEach(function(n){t[n]=n===e.state.activeForm}),React.createElement("div",{className:"sql-login-wrap"},React.createElement("button",{className:"sql-login-button button tiny",style:s,onClick:this.handleLoginButtonClick},this.state.isLoggedIn?"Logout":"Login"),React.createElement(i,{visible:this.state.userFormIsVisible,handleClose:this.handleClose},React.createElement("div",{id:"sql-log-user-modal","aria-labelledby":"User"},React.createElement("div",{style:t.login?{display:"inherit"}:{display:"none"}},React.createElement(r,{endpoint:this.props.endpoint,loginCallback:this.loginCallback,handleRegisterClick:this.handleMenuClickRegister})),React.createElement("div",{style:t.register?{display:"inherit"}:{display:"none"}},React.createElement(a,{endpoint:this.props.endpoint,loginCallback:this.loginCallback,handleLoginClick:this.handleMenuClickLogin})))))}})},{"./lib/input.jsx":8,"./lib/login_form.jsx":9,"./lib/modal.jsx":10,"./lib/register_form.jsx":11,"./lib/services_handler.js":12}],7:[function(e,t,n){t.exports=React.createClass({displayName:"exports",defaultStyles:{},render:function(){if(""===this.props.message)return null;var e=this.props.styles?this.props.styles:this.defaultStyles;return React.createElement("div",{className:"alert-box alert",style:e},this.props.message)}})},{}],8:[function(e,t,n){t.exports=React.createClass({displayName:"exports",getInitialState:function(){return{value:""}},getInputValue:function(){return this.state.value},handleChange:function(e){this.setState({value:e.target.value})},render:function(){return React.createElement("div",null,React.createElement("label",null,this.props.label),React.createElement("input",{type:this.props.type,name:this.props.name,ref:this.props.ref,value:this.state.value,onChange:this.handleChange}))}})},{}],9:[function(e,t,n){var r=e("./input.jsx"),a=e("./alert.jsx"),i=e("./services_handler.js");t.exports=React.createClass({displayName:"exports",getInitialState:function(){return{errorMessage:""}},handleSubmit:function(e){e.preventDefault();var t=this,n=this.refs.email.getInputValue(),r=this.refs.password.getInputValue();i.login(this.props.endpoint,n,r,function(e,n){return e?(console.log(e),void t.setState({errorMessage:e})):(t.setState({errorMessage:""}),void(t.props.loginCallback&&t.props.loginCallback(n)))})},render:function(){return React.createElement("div",{className:"sql-login-login"},React.createElement(a,{message:this.state.errorMessage}),React.createElement("form",{method:"POST",onSubmit:this.handleSubmit},React.createElement(r,{name:"email",type:"text",label:"Email",ref:"email"}),React.createElement(r,{name:"password",type:"password",label:"Password",ref:"password"}),React.createElement("input",{className:"button tiny",type:"submit",value:"Login"}),React.createElement("a",{style:{paddingLeft:"12px",fontSize:"10px"},onClick:this.props.handleRegisterClick},"Register")))}})},{"./alert.jsx":7,"./input.jsx":8,"./services_handler.js":12}],10:[function(e,t,n){t.exports=React.createClass({displayName:"exports",render:function(){var e={position:"absolute",width:"100%",height:"100%",top:0,left:0,backgroundColor:"rgba(0, 0, 0, 0.3)",zIndex:100},t=.92*window.innerHeight,n={margin:"0 auto",marginTop:"20px",backgroundColor:"#FFF",padding:"20px",boxShadow:"0 0 25px #444444",overflow:"scroll",maxHeight:t},r={marginTop:"-20px",marginLeft:"-10px",width:"100%"},a={color:"#000",fontWeight:100,fontSize:"30px",cursor:"pointer",top:"20px",left:"20px"},i=this.props.size?this.props.size:"small",o="";return o="small"===i?"small-12 medium-8 large-6":"medium"===i?"small-12 medium-10 large-8":"small-12 medium-10",this.props.visible||(e.display="none"),React.createElement("div",{style:e},React.createElement("div",{className:"row"},React.createElement("div",{style:n,className:o},React.createElement("div",{style:r},React.createElement("div",{style:a,onClick:this.props.handleClose},"X")),this.props.children)))}})},{}],11:[function(e,t,n){function r(e,t){return e.length<t?!1:/^([a-zA-Z0-9]|\-|\_|\.)+$/.test(e)}function a(e){var t=/^([\w-]+(?:\.[\w-]+)*)@((?:[\w-]+\.)*\w[\w-]{0,66})\.([a-z]{2,6}(?:\.[a-z]{2})?)$/i;return t.test(e)}var i=e("./alert.jsx"),o=e("./input.jsx"),s=e("./services_handler.js");t.exports=React.createClass({displayName:"exports",passwordMinLength:8,usernameMinLength:3,errorEmail:"Email address is not valid.",errorPasswordsDontMatch:"The passwords do not match.",errorPasswordLength:"The password must be at least 8 characters.",errorUsernameLength:"The username can only contain letters, numbers, underscores, dots and dashes and must be at least 3 characters.",getInitialState:function(){return{errorMessage:""}},handleSubmit:function(e){e.preventDefault();var t=this,n=this.refs.email.getInputValue(),r=this.refs.username.getInputValue(),a=this.refs.password.getInputValue(),i=this.refs.confirmPassword.getInputValue(),o=this.validate(n,r,a,i);return o!==!0?void this.setState({errorMessage:o}):(console.log("Registering "+n),void s.register(this.props.endpoint,n,r,a,function(e,n){return e?(console.log(e),void t.setState({errorMessage:e})):(t.setState({errorMessage:""}),void(t.props.loginCallback&&t.props.loginCallback(n.user)))}))},render:function(){return React.createElement("div",{className:"sql-login-register"},React.createElement(i,{message:this.state.errorMessage}),React.createElement("form",{method:"POST",onSubmit:this.handleSubmit},React.createElement(o,{name:"email",type:"text",label:"Email",ref:"email"}),React.createElement(o,{name:"username",type:"text",label:"Username",ref:"username"}),React.createElement(o,{name:"password",type:"password",label:"Password",ref:"password"}),React.createElement(o,{name:"confirmPassword",type:"password",label:"ConfirmPassword",ref:"confirmPassword"}),React.createElement("input",{className:"button tiny",type:"submit",value:"Register"}),React.createElement("a",{style:{paddingLeft:"12px",fontSize:"10px"},onClick:this.props.handleLoginClick},"Login")))},validate:function(e,t,n,i){return a(e)?r(t,this.usernameMinLength)?n!==i?this.errorPasswordsDontMatch:n.length<this.passwordMinLength?this.errorPasswordLength:!0:this.errorUsernameLength:this.errorEmail}})},{"./alert.jsx":7,"./input.jsx":8,"./services_handler.js":12}],12:[function(e,t,n){var r="success",a="failure",i="error";t.exports={getUser:function(e,t){o({method:"GET",url:e},function(e,n){e?t(e):n&&n.id?t(null,n):t(null,null);
})},register:function(e,t,n,r,a){o({method:"POST",url:e+"/register",data:{email:t,username:n,password:r}},a)},login:function(e,t,n,r){o({method:"POST",url:e+"/login",data:{email:t,password:n}},r)},logout:function(e,t){o({method:"POST",url:e+"/logout"},t)}};var o=function(e,t){e.success=function(e){e.status===r?t(null,e.data):t(e.status===a||e.status===i?e.message:"An error occurred.")},e.error=function(e,n,r){t("Error contacting server.")},$.ajax(e)}},{}],13:[function(e,t,n){var r=e("./lib/user/lib/modal.jsx"),a="map-canvas",i=e("./lib/geo_lit"),o=e("../config");i.init(a,function(e){e?console.log(e):console.log("map initialzed")});var s=e("./components/addPlaceForm.jsx"),l=e("./components/comments.jsx"),c=e("./lib/user/index.jsx"),u=React.createClass({displayName:"Main",addPlaceCallback:function(e){var t=this;t.setState({activeComponent:"comments",placeId:e._id,placeTitle:e.title})},componentDidMount:function(){var e=this;$(document).on("geo-lit-place-click",function(t,n){e.setState({activeComponent:"comments",placeId:n._id,placeTitle:n.title})})},getInitialState:function(){return{activeComponent:"addPlaceForm",placeId:null,userId:null,user:null,isLoggedIn:!1}},handleCommentModalClose:function(){this.setState({activeComponent:null})},loginCallback:function(e){i.setUser(e),this.setState({user:e,userId:e.id,isLoggedIn:!0})},logoutCallback:function(){this.setState({user:null,userId:null,isLoggedIn:!1})},render:function(){var e=this,t=null;e.state.isLoggedIn&&(t=React.createElement(s,{activeComponent:e.state.activeComponent,addPlaceCallback:e.addPlaceCallback}));var n=null;return"comments"===this.state.activeComponent&&(n=React.createElement(r,{handleClose:this.handleCommentModalClose,size:"large",visible:!0},React.createElement("h2",null,this.state.placeTitle),React.createElement(l,{activeComponent:this.state.activeComponent,endpoint:o.commentEndpoint,placeId:this.state.placeId,placeTitle:this.state.placeTitle,userId:this.state.userId}))),React.createElement("div",null,React.createElement(c,{endpoint:o.userEndpoint,loginCallback:this.loginCallback,logoutCallback:this.logoutCallback}),t,n)}});React.render(React.createElement(u,null),document.getElementById("content"))},{"../config":14,"./components/addPlaceForm.jsx":1,"./components/comments.jsx":2,"./lib/geo_lit":3,"./lib/user/index.jsx":6,"./lib/user/lib/modal.jsx":10}],14:[function(e,t,n){var r={};-1!==window.location.href.toLowerCase().indexOf("localhost")||-1!==window.location.href.toLowerCase().indexOf("0.0.0.0")?r.environment="development":r.environment="production","development"===r.environment?(r.geoLitEndpoint="http://localhost:3000",r.testing=!0):r.testing=!1,r.commentEndpoint=r.geoLitEndpoint+"/discussion",r.userEndpoint=r.geoLitEndpoint+"/user",t.exports=r},{}],15:[function(e,t,n){(function(){function e(e){function t(t,n,r,a,i,o){for(;i>=0&&o>i;i+=e){var s=a?a[i]:i;r=n(r,t[s],s,t)}return r}return function(n,r,a,i){r=k(r,i,4);var o=!D(n)&&_.keys(n),s=(o||n).length,l=e>0?0:s-1;return arguments.length<3&&(a=n[o?o[l]:l],l+=e),t(n,r,a,o,l,s)}}function r(e){return function(t,n,r){n=C(n,r);for(var a=E(t),i=e>0?0:a-1;i>=0&&a>i;i+=e)if(n(t[i],i,t))return i;return-1}}function a(e,t,n){return function(r,a,i){var o=0,s=E(r);if("number"==typeof i)e>0?o=i>=0?i:Math.max(i+s,o):s=i>=0?Math.min(i+1,s):i+s+1;else if(n&&i&&s)return i=n(r,a),r[i]===a?i:-1;if(a!==a)return i=t(d.call(r,o,s),_.isNaN),i>=0?i+o:-1;for(i=e>0?o:s-1;i>=0&&s>i;i+=e)if(r[i]===a)return i;return-1}}function i(e,t){var n=P.length,r=e.constructor,a=_.isFunction(r)&&r.prototype||c,i="constructor";for(_.has(e,i)&&!_.contains(t,i)&&t.push(i);n--;)i=P[n],i in e&&e[i]!==a[i]&&!_.contains(t,i)&&t.push(i)}var o=this,s=o._,l=Array.prototype,c=Object.prototype,u=Function.prototype,p=l.push,d=l.slice,m=c.toString,f=c.hasOwnProperty,g=Array.isArray,h=Object.keys,v=u.bind,y=Object.create,b=function(){},_=function(e){return e instanceof _?e:this instanceof _?void(this._wrapped=e):new _(e)};"undefined"!=typeof n?("undefined"!=typeof t&&t.exports&&(n=t.exports=_),n._=_):o._=_,_.VERSION="1.8.3";var k=function(e,t,n){if(void 0===t)return e;switch(null==n?3:n){case 1:return function(n){return e.call(t,n)};case 2:return function(n,r){return e.call(t,n,r)};case 3:return function(n,r,a){return e.call(t,n,r,a)};case 4:return function(n,r,a,i){return e.call(t,n,r,a,i)}}return function(){return e.apply(t,arguments)}},C=function(e,t,n){return null==e?_.identity:_.isFunction(e)?k(e,t,n):_.isObject(e)?_.matcher(e):_.property(e)};_.iteratee=function(e,t){return C(e,t,1/0)};var x=function(e,t){return function(n){var r=arguments.length;if(2>r||null==n)return n;for(var a=1;r>a;a++)for(var i=arguments[a],o=e(i),s=o.length,l=0;s>l;l++){var c=o[l];t&&void 0!==n[c]||(n[c]=i[c])}return n}},T=function(e){if(!_.isObject(e))return{};if(y)return y(e);b.prototype=e;var t=new b;return b.prototype=null,t},w=function(e){return function(t){return null==t?void 0:t[e]}},L=Math.pow(2,53)-1,E=w("length"),D=function(e){var t=E(e);return"number"==typeof t&&t>=0&&L>=t};_.each=_.forEach=function(e,t,n){t=k(t,n);var r,a;if(D(e))for(r=0,a=e.length;a>r;r++)t(e[r],r,e);else{var i=_.keys(e);for(r=0,a=i.length;a>r;r++)t(e[i[r]],i[r],e)}return e},_.map=_.collect=function(e,t,n){t=C(t,n);for(var r=!D(e)&&_.keys(e),a=(r||e).length,i=Array(a),o=0;a>o;o++){var s=r?r[o]:o;i[o]=t(e[s],s,e)}return i},_.reduce=_.foldl=_.inject=e(1),_.reduceRight=_.foldr=e(-1),_.find=_.detect=function(e,t,n){var r;return r=D(e)?_.findIndex(e,t,n):_.findKey(e,t,n),void 0!==r&&-1!==r?e[r]:void 0},_.filter=_.select=function(e,t,n){var r=[];return t=C(t,n),_.each(e,function(e,n,a){t(e,n,a)&&r.push(e)}),r},_.reject=function(e,t,n){return _.filter(e,_.negate(C(t)),n)},_.every=_.all=function(e,t,n){t=C(t,n);for(var r=!D(e)&&_.keys(e),a=(r||e).length,i=0;a>i;i++){var o=r?r[i]:i;if(!t(e[o],o,e))return!1}return!0},_.some=_.any=function(e,t,n){t=C(t,n);for(var r=!D(e)&&_.keys(e),a=(r||e).length,i=0;a>i;i++){var o=r?r[i]:i;if(t(e[o],o,e))return!0}return!1},_.contains=_.includes=_.include=function(e,t,n,r){return D(e)||(e=_.values(e)),("number"!=typeof n||r)&&(n=0),_.indexOf(e,t,n)>=0},_.invoke=function(e,t){var n=d.call(arguments,2),r=_.isFunction(t);return _.map(e,function(e){var a=r?t:e[t];return null==a?a:a.apply(e,n)})},_.pluck=function(e,t){return _.map(e,_.property(t))},_.where=function(e,t){return _.filter(e,_.matcher(t))},_.findWhere=function(e,t){return _.find(e,_.matcher(t))},_.max=function(e,t,n){var r,a,i=-(1/0),o=-(1/0);if(null==t&&null!=e){e=D(e)?e:_.values(e);for(var s=0,l=e.length;l>s;s++)r=e[s],r>i&&(i=r)}else t=C(t,n),_.each(e,function(e,n,r){a=t(e,n,r),(a>o||a===-(1/0)&&i===-(1/0))&&(i=e,o=a)});return i},_.min=function(e,t,n){var r,a,i=1/0,o=1/0;if(null==t&&null!=e){e=D(e)?e:_.values(e);for(var s=0,l=e.length;l>s;s++)r=e[s],i>r&&(i=r)}else t=C(t,n),_.each(e,function(e,n,r){a=t(e,n,r),(o>a||a===1/0&&i===1/0)&&(i=e,o=a)});return i},_.shuffle=function(e){for(var t,n=D(e)?e:_.values(e),r=n.length,a=Array(r),i=0;r>i;i++)t=_.random(0,i),t!==i&&(a[i]=a[t]),a[t]=n[i];return a},_.sample=function(e,t,n){return null==t||n?(D(e)||(e=_.values(e)),e[_.random(e.length-1)]):_.shuffle(e).slice(0,Math.max(0,t))},_.sortBy=function(e,t,n){return t=C(t,n),_.pluck(_.map(e,function(e,n,r){return{value:e,index:n,criteria:t(e,n,r)}}).sort(function(e,t){var n=e.criteria,r=t.criteria;if(n!==r){if(n>r||void 0===n)return 1;if(r>n||void 0===r)return-1}return e.index-t.index}),"value")};var S=function(e){return function(t,n,r){var a={};return n=C(n,r),_.each(t,function(r,i){var o=n(r,i,t);e(a,r,o)}),a}};_.groupBy=S(function(e,t,n){_.has(e,n)?e[n].push(t):e[n]=[t]}),_.indexBy=S(function(e,t,n){e[n]=t}),_.countBy=S(function(e,t,n){_.has(e,n)?e[n]++:e[n]=1}),_.toArray=function(e){return e?_.isArray(e)?d.call(e):D(e)?_.map(e,_.identity):_.values(e):[]},_.size=function(e){return null==e?0:D(e)?e.length:_.keys(e).length},_.partition=function(e,t,n){t=C(t,n);var r=[],a=[];return _.each(e,function(e,n,i){(t(e,n,i)?r:a).push(e)}),[r,a]},_.first=_.head=_.take=function(e,t,n){return null!=e?null==t||n?e[0]:_.initial(e,e.length-t):void 0},_.initial=function(e,t,n){return d.call(e,0,Math.max(0,e.length-(null==t||n?1:t)))},_.last=function(e,t,n){return null!=e?null==t||n?e[e.length-1]:_.rest(e,Math.max(0,e.length-t)):void 0},_.rest=_.tail=_.drop=function(e,t,n){return d.call(e,null==t||n?1:t)},_.compact=function(e){return _.filter(e,_.identity)};var R=function(e,t,n,r){for(var a=[],i=0,o=r||0,s=E(e);s>o;o++){var l=e[o];if(D(l)&&(_.isArray(l)||_.isArguments(l))){t||(l=R(l,t,n));var c=0,u=l.length;for(a.length+=u;u>c;)a[i++]=l[c++]}else n||(a[i++]=l)}return a};_.flatten=function(e,t){return R(e,t,!1)},_.without=function(e){return _.difference(e,d.call(arguments,1))},_.uniq=_.unique=function(e,t,n,r){_.isBoolean(t)||(r=n,n=t,t=!1),null!=n&&(n=C(n,r));for(var a=[],i=[],o=0,s=E(e);s>o;o++){var l=e[o],c=n?n(l,o,e):l;t?(o&&i===c||a.push(l),i=c):n?_.contains(i,c)||(i.push(c),a.push(l)):_.contains(a,l)||a.push(l)}return a},_.union=function(){return _.uniq(R(arguments,!0,!0))},_.intersection=function(e){for(var t=[],n=arguments.length,r=0,a=E(e);a>r;r++){var i=e[r];if(!_.contains(t,i)){for(var o=1;n>o&&_.contains(arguments[o],i);o++);o===n&&t.push(i)}}return t},_.difference=function(e){var t=R(arguments,!0,!0,1);return _.filter(e,function(e){return!_.contains(t,e)})},_.zip=function(){return _.unzip(arguments)},_.unzip=function(e){for(var t=e&&_.max(e,E).length||0,n=Array(t),r=0;t>r;r++)n[r]=_.pluck(e,r);return n},_.object=function(e,t){for(var n={},r=0,a=E(e);a>r;r++)t?n[e[r]]=t[r]:n[e[r][0]]=e[r][1];return n},_.findIndex=r(1),_.findLastIndex=r(-1),_.sortedIndex=function(e,t,n,r){n=C(n,r,1);for(var a=n(t),i=0,o=E(e);o>i;){var s=Math.floor((i+o)/2);n(e[s])<a?i=s+1:o=s}return i},_.indexOf=a(1,_.findIndex,_.sortedIndex),_.lastIndexOf=a(-1,_.findLastIndex),_.range=function(e,t,n){null==t&&(t=e||0,e=0),n=n||1;for(var r=Math.max(Math.ceil((t-e)/n),0),a=Array(r),i=0;r>i;i++,e+=n)a[i]=e;return a};var I=function(e,t,n,r,a){if(!(r instanceof t))return e.apply(n,a);var i=T(e.prototype),o=e.apply(i,a);return _.isObject(o)?o:i};_.bind=function(e,t){if(v&&e.bind===v)return v.apply(e,d.call(arguments,1));if(!_.isFunction(e))throw new TypeError("Bind must be called on a function");var n=d.call(arguments,2),r=function(){return I(e,r,t,this,n.concat(d.call(arguments)))};return r},_.partial=function(e){var t=d.call(arguments,1),n=function(){for(var r=0,a=t.length,i=Array(a),o=0;a>o;o++)i[o]=t[o]===_?arguments[r++]:t[o];for(;r<arguments.length;)i.push(arguments[r++]);return I(e,n,this,this,i)};return n},_.bindAll=function(e){var t,n,r=arguments.length;if(1>=r)throw new Error("bindAll must be passed function names");for(t=1;r>t;t++)n=arguments[t],e[n]=_.bind(e[n],e);return e},_.memoize=function(e,t){var n=function(r){var a=n.cache,i=""+(t?t.apply(this,arguments):r);return _.has(a,i)||(a[i]=e.apply(this,arguments)),a[i]};return n.cache={},n},_.delay=function(e,t){var n=d.call(arguments,2);return setTimeout(function(){return e.apply(null,n)},t)},_.defer=_.partial(_.delay,_,1),_.throttle=function(e,t,n){var r,a,i,o=null,s=0;n||(n={});var l=function(){s=n.leading===!1?0:_.now(),o=null,i=e.apply(r,a),o||(r=a=null)};return function(){var c=_.now();s||n.leading!==!1||(s=c);var u=t-(c-s);return r=this,a=arguments,0>=u||u>t?(o&&(clearTimeout(o),o=null),s=c,i=e.apply(r,a),o||(r=a=null)):o||n.trailing===!1||(o=setTimeout(l,u)),i}},_.debounce=function(e,t,n){var r,a,i,o,s,l=function(){var c=_.now()-o;t>c&&c>=0?r=setTimeout(l,t-c):(r=null,n||(s=e.apply(i,a),r||(i=a=null)))};return function(){i=this,a=arguments,o=_.now();var c=n&&!r;return r||(r=setTimeout(l,t)),c&&(s=e.apply(i,a),i=a=null),s}},_.wrap=function(e,t){return _.partial(t,e)},_.negate=function(e){return function(){return!e.apply(this,arguments)}},_.compose=function(){var e=arguments,t=e.length-1;return function(){for(var n=t,r=e[t].apply(this,arguments);n--;)r=e[n].call(this,r);return r}},_.after=function(e,t){return function(){return--e<1?t.apply(this,arguments):void 0}},_.before=function(e,t){var n;return function(){return--e>0&&(n=t.apply(this,arguments)),1>=e&&(t=null),n}},_.once=_.partial(_.before,2);var j=!{toString:null}.propertyIsEnumerable("toString"),P=["valueOf","isPrototypeOf","toString","propertyIsEnumerable","hasOwnProperty","toLocaleString"];_.keys=function(e){if(!_.isObject(e))return[];if(h)return h(e);var t=[];for(var n in e)_.has(e,n)&&t.push(n);return j&&i(e,t),t},_.allKeys=function(e){if(!_.isObject(e))return[];var t=[];for(var n in e)t.push(n);return j&&i(e,t),t},_.values=function(e){for(var t=_.keys(e),n=t.length,r=Array(n),a=0;n>a;a++)r[a]=e[t[a]];return r},_.mapObject=function(e,t,n){t=C(t,n);for(var r,a=_.keys(e),i=a.length,o={},s=0;i>s;s++)r=a[s],o[r]=t(e[r],r,e);return o},_.pairs=function(e){for(var t=_.keys(e),n=t.length,r=Array(n),a=0;n>a;a++)r[a]=[t[a],e[t[a]]];return r},_.invert=function(e){for(var t={},n=_.keys(e),r=0,a=n.length;a>r;r++)t[e[n[r]]]=n[r];return t},_.functions=_.methods=function(e){var t=[];for(var n in e)_.isFunction(e[n])&&t.push(n);return t.sort()},_.extend=x(_.allKeys),_.extendOwn=_.assign=x(_.keys),_.findKey=function(e,t,n){t=C(t,n);for(var r,a=_.keys(e),i=0,o=a.length;o>i;i++)if(r=a[i],t(e[r],r,e))return r},_.pick=function(e,t,n){var r,a,i={},o=e;if(null==o)return i;_.isFunction(t)?(a=_.allKeys(o),r=k(t,n)):(a=R(arguments,!1,!1,1),r=function(e,t,n){return t in n},o=Object(o));for(var s=0,l=a.length;l>s;s++){var c=a[s],u=o[c];r(u,c,o)&&(i[c]=u)}return i},_.omit=function(e,t,n){if(_.isFunction(t))t=_.negate(t);else{var r=_.map(R(arguments,!1,!1,1),String);t=function(e,t){return!_.contains(r,t)}}return _.pick(e,t,n)},_.defaults=x(_.allKeys,!0),_.create=function(e,t){var n=T(e);return t&&_.extendOwn(n,t),n},_.clone=function(e){return _.isObject(e)?_.isArray(e)?e.slice():_.extend({},e):e},_.tap=function(e,t){return t(e),e},_.isMatch=function(e,t){var n=_.keys(t),r=n.length;if(null==e)return!r;for(var a=Object(e),i=0;r>i;i++){var o=n[i];if(t[o]!==a[o]||!(o in a))return!1}return!0};var M=function(e,t,n,r){if(e===t)return 0!==e||1/e===1/t;if(null==e||null==t)return e===t;e instanceof _&&(e=e._wrapped),t instanceof _&&(t=t._wrapped);var a=m.call(e);if(a!==m.call(t))return!1;switch(a){case"[object RegExp]":case"[object String]":return""+e==""+t;case"[object Number]":return+e!==+e?+t!==+t:0===+e?1/+e===1/t:+e===+t;case"[object Date]":case"[object Boolean]":return+e===+t}var i="[object Array]"===a;if(!i){if("object"!=typeof e||"object"!=typeof t)return!1;var o=e.constructor,s=t.constructor;if(o!==s&&!(_.isFunction(o)&&o instanceof o&&_.isFunction(s)&&s instanceof s)&&"constructor"in e&&"constructor"in t)return!1}n=n||[],r=r||[];for(var l=n.length;l--;)if(n[l]===e)return r[l]===t;if(n.push(e),r.push(t),i){if(l=e.length,l!==t.length)return!1;for(;l--;)if(!M(e[l],t[l],n,r))return!1}else{var c,u=_.keys(e);if(l=u.length,_.keys(t).length!==l)return!1;for(;l--;)if(c=u[l],!_.has(t,c)||!M(e[c],t[c],n,r))return!1}return n.pop(),r.pop(),!0};_.isEqual=function(e,t){return M(e,t)},_.isEmpty=function(e){return null==e?!0:D(e)&&(_.isArray(e)||_.isString(e)||_.isArguments(e))?0===e.length:0===_.keys(e).length},_.isElement=function(e){return!(!e||1!==e.nodeType)},_.isArray=g||function(e){return"[object Array]"===m.call(e)},_.isObject=function(e){var t=typeof e;return"function"===t||"object"===t&&!!e},_.each(["Arguments","Function","String","Number","Date","RegExp","Error"],function(e){_["is"+e]=function(t){return m.call(t)==="[object "+e+"]"}}),_.isArguments(arguments)||(_.isArguments=function(e){return _.has(e,"callee")}),"function"!=typeof/./&&"object"!=typeof Int8Array&&(_.isFunction=function(e){return"function"==typeof e||!1}),_.isFinite=function(e){return isFinite(e)&&!isNaN(parseFloat(e))},_.isNaN=function(e){return _.isNumber(e)&&e!==+e},_.isBoolean=function(e){return e===!0||e===!1||"[object Boolean]"===m.call(e)},_.isNull=function(e){return null===e},_.isUndefined=function(e){return void 0===e},_.has=function(e,t){return null!=e&&f.call(e,t)},_.noConflict=function(){return o._=s,this},_.identity=function(e){return e},_.constant=function(e){return function(){return e}},_.noop=function(){},_.property=w,_.propertyOf=function(e){return null==e?function(){}:function(t){return e[t]}},_.matcher=_.matches=function(e){return e=_.extendOwn({},e),function(t){return _.isMatch(t,e)}},_.times=function(e,t,n){var r=Array(Math.max(0,e));t=k(t,n,1);for(var a=0;e>a;a++)r[a]=t(a);return r},_.random=function(e,t){return null==t&&(t=e,e=0),e+Math.floor(Math.random()*(t-e+1))},_.now=Date.now||function(){return(new Date).getTime()};var N={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},O=_.invert(N),F=function(e){var t=function(t){return e[t]},n="(?:"+_.keys(e).join("|")+")",r=RegExp(n),a=RegExp(n,"g");return function(e){return e=null==e?"":""+e,r.test(e)?e.replace(a,t):e}};_.escape=F(N),_.unescape=F(O),_.result=function(e,t,n){var r=null==e?void 0:e[t];return void 0===r&&(r=n),_.isFunction(r)?r.call(e):r};var A=0;_.uniqueId=function(e){var t=++A+"";return e?e+t:t},_.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var V=/(.)^/,z={"'":"'","\\":"\\","\r":"r","\n":"n","\u2028":"u2028","\u2029":"u2029"},U=/\\|'|\r|\n|\u2028|\u2029/g,q=function(e){return"\\"+z[e]};_.template=function(e,t,n){!t&&n&&(t=n),t=_.defaults({},t,_.templateSettings);var r=RegExp([(t.escape||V).source,(t.interpolate||V).source,(t.evaluate||V).source].join("|")+"|$","g"),a=0,i="__p+='";e.replace(r,function(t,n,r,o,s){return i+=e.slice(a,s).replace(U,q),a=s+t.length,n?i+="'+\n((__t=("+n+"))==null?'':_.escape(__t))+\n'":r?i+="'+\n((__t=("+r+"))==null?'':__t)+\n'":o&&(i+="';\n"+o+"\n__p+='"),t}),i+="';\n",t.variable||(i="with(obj||{}){\n"+i+"}\n"),i="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+i+"return __p;\n";try{var o=new Function(t.variable||"obj","_",i)}catch(s){throw s.source=i,s}var l=function(e){return o.call(this,e,_)},c=t.variable||"obj";return l.source="function("+c+"){\n"+i+"}",l},_.chain=function(e){var t=_(e);return t._chain=!0,t};var B=function(e,t){return e._chain?_(t).chain():t};_.mixin=function(e){_.each(_.functions(e),function(t){var n=_[t]=e[t];_.prototype[t]=function(){var e=[this._wrapped];return p.apply(e,arguments),B(this,n.apply(_,e))}})},_.mixin(_),_.each(["pop","push","reverse","shift","sort","splice","unshift"],function(e){var t=l[e];_.prototype[e]=function(){var n=this._wrapped;return t.apply(n,arguments),"shift"!==e&&"splice"!==e||0!==n.length||delete n[0],B(this,n)}}),_.each(["concat","join","slice"],function(e){var t=l[e];_.prototype[e]=function(){return B(this,t.apply(this._wrapped,arguments))}}),_.prototype.value=function(){return this._wrapped},_.prototype.valueOf=_.prototype.toJSON=_.prototype.value,_.prototype.toString=function(){return""+this._wrapped},"function"==typeof define&&define.amd&&define("underscore",[],function(){return _})}).call(this)},{}]},{},[13]);